#!perl -ln
$i=0;map$b[$..$i++]=$_,'',split//;
sub j{push@{$l{$_[0]}},"@_[2,1]"if$_[3]eq$"?$b[$_[1].$_[2]]eq$":$b[$_[0]]eq w}
for(1..length){
{b=>sub{},w=>sub{
    $l{$c}=$l{$.-1 .$_}if$b[$.-1 .$_]eq w;
    $l{$c}=$l{$..($_-1)}if$b[$..($_-1)]eq w;
    j $..$_,$.-1,$_,$";
    j $..$_,$.,$_-1,$";
},$",sub{
    j $.-1 .$_,$.,$_;
    j $..($_-1),$.,$_;
}}->{$b[$c="$.$_"]}->()
}}{print for sort map@{$l{$_}}-1?():"$l{$_}[0]",keys%l;
